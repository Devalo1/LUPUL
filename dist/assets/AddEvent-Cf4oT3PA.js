import{g as e,j as a,d as t,i}from"./index-Bwkz9jAa.js";import{u as n,b as s}from"./vendor-ClDHXAES.js";import{T as l,M as r,q as o,U as d,V as c,W as m}from"./firebase-DUCcfN4Q.js";const u=()=>{const{isAdmin:u}=e(),p=n(),[x,g]=s.useState(!1),[h,b]=s.useState(null),[v,f]=s.useState(!1),[j,y]=s.useState(null),[w,N]=s.useState(""),[C,k]=s.useState({title:"",description:"",date:"",time:"",location:"",imageUrl:"",capacity:20}),A=e=>{const{name:a,value:t}=e.target;k((e=>({...e,[a]:t})))};return u?a.jsx(a.Fragment,{children:a.jsx("div",{className:"container mx-auto px-4 py-8",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Adaugă Eveniment Nou"}),h&&a.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:h}),v&&a.jsx("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:"Evenimentul a fost adăugat cu succes! Vei fi redirecționat în curând."}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),C.title?C.date?C.location?j||w||(b("Te rugăm să încarci o imagine pentru eveniment."),0):(b("Locația evenimentului este obligatorie."),0):(b("Data evenimentului este obligatorie."),0):(b("Titlul evenimentului este obligatoriu."),0))try{g(!0),b(null);const e=await(async e=>{if(!e)return"/images/BussinesLider.jpg";try{const a=(new Date).getTime(),t=e.name.split(".").pop(),n=d(i,`events/event_${a}.${t}`);return await c(n,e),await m(n),"/images/Afis 2.jpg"}catch(a){throw new Error("Nu s-a putut procesa imaginea. Vă rugăm să încercați din nou.")}})(j),a={...C,imageUrl:e,createdAt:l.now(),createdBy:"unknown",updatedAt:l.now(),updatedBy:"unknown",registeredUsers:[]},n=await r(o(t,"events"),a);f(!0),k({title:"",description:"",date:"",time:"",location:"",imageUrl:"",capacity:20}),y(null),N(""),setTimeout((()=>{p(`/events/${n.id}`)}),3e3)}catch(a){b("A apărut o eroare la salvarea evenimentului. Vă rugăm să încercați din nou.")}finally{g(!1)}},children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"title",children:"Titlu Eveniment*"}),a.jsx("input",{type:"text",id:"title",name:"title",value:C.title,onChange:A,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Introduceți titlul evenimentului",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"date",children:"Data Eveniment*"}),a.jsx("input",{type:"date",id:"date",name:"date",value:C.date,onChange:A,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"time",children:"Ora Eveniment"}),a.jsx("input",{type:"time",id:"time",name:"time",value:C.time,onChange:A,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"location",children:"Locație*"}),a.jsx("input",{type:"text",id:"location",name:"location",value:C.location,onChange:A,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Introduceți locația evenimentului",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"capacity",children:"Capacitate (număr participanți)"}),a.jsx("input",{type:"number",id:"capacity",name:"capacity",value:C.capacity,onChange:A,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",min:"1"})]}),a.jsxs("div",{className:"mb-4 md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"description",children:"Descriere Eveniment"}),a.jsx("textarea",{id:"description",name:"description",value:C.description,onChange:A,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",rows:5,placeholder:"Introduceți descrierea evenimentului"})]}),a.jsxs("div",{className:"mb-4 md:col-span-2",children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"eventImage",children:"Imagine Eveniment*"}),a.jsx("input",{type:"file",id:"eventImage",accept:"image/*",onChange:e=>{var a;const t=null==(a=e.target.files)?void 0:a[0];if(!t)return;if(t.size>5242880)return void b("Imaginea este prea mare. Mărimea maximă acceptată este de 5MB.");if(!t.type.startsWith("image/"))return void b("Te rugăm să încarci doar fișiere de tip imagine.");y(t);const i=new FileReader;i.onload=()=>{N(i.result)},i.readAsDataURL(t),b(null)},className:"hidden"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("label",{htmlFor:"eventImage",className:"cursor-pointer px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:w?"Schimbă Imaginea":"Încarcă Imagine"}),w&&a.jsxs("span",{className:"text-sm text-gray-600",children:["Imagine selectată: ",null==j?void 0:j.name]})]}),w&&a.jsxs("div",{className:"mt-4 relative",children:[a.jsx("img",{src:w,alt:"Previzualizare",className:"w-full max-h-64 object-contain border rounded"}),a.jsx("button",{type:"button",onClick:()=>{N(""),y(null),k((e=>({...e,imageUrl:""})))},className:"absolute top-2 right-2 bg-red-600 text-white rounded-full p-1 hover:bg-red-700",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:'Format recomandat: JPEG sau PNG, dimensiune maximă 5MB. Pentru evenimente importante folosiți imaginea "Afis 2.jpg" din folderul public/images.'})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[a.jsx("a",{href:"/admin",className:"px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400",children:"Înapoi la Panoul Administrativ"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 "+(x?"opacity-50 cursor-not-allowed":""),disabled:x,children:x?a.jsxs("span",{className:"flex items-center",children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Se procesează..."]}):"Adaugă Eveniment"})]})]})]})})}):a.jsx("div",{className:"container mx-auto px-4 py-8",children:a.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[a.jsx("p",{children:"Doar administratorii pot adăuga evenimente noi."}),a.jsx("a",{href:"/",className:"underline",children:"Înapoi la pagina principală"})]})})};export{u as default};
