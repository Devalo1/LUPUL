import{d as e,j as a}from"./index-Bwkz9jAa.js";import{b as r}from"./vendor-ClDHXAES.js";import{q as s,s as t,K as i,t as l,u as n,N as d,T as o,M as c,S as m}from"./firebase-DUCcfN4Q.js";import{u}from"./useCategories-D2o_3hCJ.js";const g=()=>{const[g,x]=r.useState([]),[p,h]=r.useState({name:"",slug:"",description:"",order:0}),[b,f]=r.useState(null),[y,j]=r.useState(!0),[N,v]=r.useState(null),[w,C]=r.useState(null),U=u();r.useEffect((()=>{k()}),[]);const k=async()=>{try{j(!0);const a=s(e,"categories"),r=t(a,i("order","asc")),n=await l(r);if(n.empty)x(U.categories);else{const e=n.docs.map((e=>({id:e.id,name:e.data().name||"",slug:e.data().slug||"",description:e.data().description||"",imageUrl:e.data().imageUrl||"",parentId:e.data().parentId||void 0,order:e.data().order||0})));x(e)}}catch(a){v("A apărut o eroare la încărcarea categoriilor.")}finally{j(!1)}},A=e=>{const{name:a,value:r}=e.target;if(b)f({...b,[a]:r});else if("name"===a&&!p.slug&&r){const e=r.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");h({...p,name:r,slug:e})}else h({...p,[a]:r})},S=()=>{h({name:"",slug:"",description:"",order:0}),f(null)};return a.jsx("div",{className:"container mx-auto px-4 py-8",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[a.jsx("h2",{className:"text-xl font-bold mb-6",children:"Gestionare Categorii"}),w&&a.jsx("div",{className:"mb-4 p-4 bg-green-100 border-l-4 border-green-500 text-green-700",children:a.jsx("p",{children:w})}),N&&a.jsx("div",{className:"mb-4 p-4 bg-red-100 border-l-4 border-red-500 text-red-700",children:a.jsx("p",{children:N})}),a.jsxs("form",{onSubmit:b?async a=>{if(a.preventDefault(),b&&b.name&&b.slug)try{j(!0),v(null);if(g.find((e=>e.slug===b.slug&&e.id!==b.id)))return v("Acest slug există deja la altă categorie. Folosiți un slug unic."),void j(!1);const a=n(e,"categories",b.id);await d(a,{name:b.name,slug:b.slug,description:b.description||"",imageUrl:b.imageUrl||"",parentId:b.parentId||null,order:b.order||0,updatedAt:o.now()}),x(g.map((e=>e.id===b.id?b:e))),C("Categoria a fost actualizată cu succes!"),S()}catch(r){v("A apărut o eroare la actualizarea categoriei.")}finally{j(!1)}else v("Denumirea și slug-ul sunt obligatorii.")}:async a=>{if(a.preventDefault(),p.name&&p.slug)try{j(!0),v(null);if(g.find((e=>e.slug===p.slug)))return v("Acest slug există deja. Folosiți un slug unic."),void j(!1);const a=s(e,"categories"),r={id:(await c(a,{name:p.name,slug:p.slug,description:p.description||"",imageUrl:p.imageUrl||"",parentId:p.parentId||null,order:p.order||0,createdAt:o.now()})).id,name:p.name||"",slug:p.slug||"",description:p.description||"",imageUrl:p.imageUrl||"",parentId:p.parentId,order:p.order||0};x([...g,r]),C("Categoria a fost adăugată cu succes!"),S()}catch(r){v("A apărut o eroare la adăugarea categoriei.")}finally{j(!1)}else v("Denumirea și slug-ul sunt obligatorii.")},className:"mb-8",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Denumire Categorie*"}),a.jsx("input",{type:"text",id:"name",name:"name",value:b?b.name:p.name,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug Categorie* (URL-friendly)"}),a.jsx("input",{type:"text",id:"slug",name:"slug",value:b?b.slug:p.slug,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Slug-ul va fi folosit în URL-uri. Exemplu: "produse-traditionale"'})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descriere"}),a.jsx("textarea",{id:"description",name:"description",value:b?b.description:p.description,onChange:A,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700 mb-1",children:"URL Imagine"}),a.jsx("input",{type:"text",id:"imageUrl",name:"imageUrl",value:b?b.imageUrl:p.imageUrl,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com/image.jpg"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"order",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ordine Afișare"}),a.jsx("input",{type:"number",id:"order",name:"order",value:b?b.order:p.order,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",min:"0"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Categoriile sunt afișate în ordine crescătoare. Categoriile cu valori mai mici apar primele."})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[b&&a.jsx("button",{type:"button",onClick:()=>{f(null)},className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Anulează"}),a.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 "+(b?"bg-green-600 text-white hover:bg-green-700":"bg-blue-600 text-white hover:bg-blue-700"),disabled:y,children:y?"Se procesează...":b?"Actualizează Categoria":"Adaugă Categorie"})]})]}),a.jsx("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Lista Categoriilor"}),y&&0===g.length?a.jsx("div",{className:"flex justify-center items-center h-32",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):0===g.length?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nu există categorii disponibile."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full bg-white",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Denumire"}),a.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slug"}),a.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descriere"}),a.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ordine"}),a.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acțiuni"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:g.map((r=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4 text-sm",children:a.jsxs("div",{className:"flex items-center",children:[r.imageUrl?a.jsx("img",{src:r.imageUrl,alt:r.name,className:"h-8 w-8 rounded object-cover mr-3"}):a.jsx("div",{className:"h-8 w-8 rounded bg-gray-200 flex items-center justify-center mr-3",children:a.jsx("span",{className:"text-xs text-gray-500",children:"No img"})}),a.jsx("span",{className:"font-medium text-gray-900",children:r.name})]})}),a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:r.slug}),a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:r.description?a.jsx("span",{className:"truncate max-w-xs block",children:r.description}):a.jsx("span",{className:"text-gray-400 italic",children:"Fără descriere"})}),a.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:r.order||0}),a.jsx("td",{className:"py-3 px-4 text-sm",children:a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>(e=>{f(e),window.scrollTo({top:0,behavior:"smooth"})})(r),className:"text-indigo-600 hover:text-indigo-900",children:"Editează"}),a.jsx("button",{onClick:()=>(async a=>{if(window.confirm("Sunteți sigur că doriți să ștergeți această categorie? Produsele asociate vor rămâne în baza de date, dar vor fi fără categorie."))try{j(!0),v(null),await m(n(e,"categories",a)),x(g.filter((e=>e.id!==a))),C("Categoria a fost ștearsă cu succes!")}catch(r){v("A apărut o eroare la ștergerea categoriei.")}finally{j(!1)}})(r.id),className:"text-red-600 hover:text-red-900",children:"Șterge"})]})})]},r.id)))})]})})]})})};export{g as default};
