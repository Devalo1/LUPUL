import{j as e,d as a}from"./index-wFNFqtXh.js";import{f as r,u as s,b as i}from"./vendor-BbhD7xee.js";import{u as t,y as n,N as o}from"./firebase-Bc5mL6iy.js";const u=()=>{const{id:u}=r(),l=s(),[d,c]=i.useState({name:"",description:"",price:0,image:"",inStock:!0}),[m,b]=i.useState(!0),[p,x]=i.useState(null),[g,f]=i.useState(!1);i.useEffect((()=>{(async()=>{try{if(!u)return void x("ID-ul produsului lipsește.");const e=t(a,"products",u),r=await n(e);if(r.exists()){const e=r.data();c({name:e.name||"Produs fără nume",description:e.description||"Descrierea produsului nu este disponibilă.",price:"number"==typeof e.price?e.price:0,image:e.image||"/images/default-product.jpg",inStock:"boolean"!=typeof e.inStock||e.inStock})}else x("Produsul nu a fost găsit.")}catch(e){x("A apărut o eroare la încărcarea produsului.")}finally{b(!1)}})()}),[u]);const h=e=>{const{name:a,value:r}=e.target;c((e=>({...e,[a]:r})))};return m?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Se încarcă produsul..."})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Editează Produsul"}),p&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 text-red-700 rounded-md",children:p}),g&&e.jsx("div",{className:"mb-6 p-4 bg-green-100 text-green-700 rounded-md",children:"Produsul a fost actualizat cu succes! Vei fi redirecționat în curând."}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),x(null),f(!1);try{if(!u)return void x("ID-ul produsului lipsește.");const e={name:d.name.trim(),description:d.description.trim(),price:Number(d.price),image:d.image.trim(),inStock:!0===d.inStock||"true"===d.inStock,updatedAt:(new Date).toISOString()},r=t(a,"products",u);await o(r,e),f(!0),setTimeout((()=>l("/admin")),2e3)}catch(r){"permission-denied"===r.code?x("Nu ai permisiunea de a actualiza acest produs."):x(`A apărut o eroare la actualizarea produsului: ${r.message}`)}},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nume"}),e.jsx("input",{type:"text",name:"name",value:d.name,onChange:h,className:"w-full px-4 py-2 border border-gray-300 bg-white rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Descriere"}),e.jsx("textarea",{name:"description",value:d.description,onChange:h,rows:5,className:"w-full px-4 py-2 border border-gray-300 bg-white rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Preț"}),e.jsx("input",{type:"number",name:"price",value:d.price,onChange:h,step:"0.01",min:"0",className:"w-full px-4 py-2 border border-gray-300 bg-white rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"URL Imagine"}),e.jsx("input",{type:"text",name:"image",value:d.image,onChange:h,className:"w-full px-4 py-2 border border-gray-300 bg-white rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"În Stoc"}),e.jsxs("select",{name:"inStock",value:d.inStock?"true":"false",onChange:h,className:"w-full px-4 py-2 border border-gray-300 bg-white rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"true",children:"Da"}),e.jsx("option",{value:"false",children:"Nu"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Salvează"}),e.jsx("button",{type:"button",onClick:()=>l("/admin"),className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600",children:"Anulează"})]})]})]})};export{u as default};
