import{a as e,l as a,j as t}from"./index-Bwkz9jAa.js";import{b as r,u as i,c as s,L as o}from"./vendor-ClDHXAES.js";import"./ThemeContext-DrZ0fxr9.js";import"./firebase-DUCcfN4Q.js";const n=a.createLogger("LoginPage"),c=()=>{const[a,c]=r.useState(""),[l,u]=r.useState(""),[d,m]=r.useState(!1),[g,f]=r.useState(""),{login:h,loginWithGoogle:p,user:b}=e(),j=i(),x=s(),v="/dashboard";n.debug("Login Page - location.state:",x.state),r.useEffect((()=>{b&&(n.debug("Utilizator deja autentificat, redirecționare către:",v),j(v,{replace:!0}))}),[b,j,v]);return t.jsx("div",{className:"login-container",children:t.jsxs("div",{className:"login-form-wrapper",children:[t.jsx("h1",{children:"Autentificare"}),g&&t.jsx("div",{className:"alert alert-danger",children:g}),t.jsxs("form",{onSubmit:async e=>{var t;if(e.preventDefault(),a&&l)try{m(!0),f(""),n.debug("Încercare de autentificare cu:",a),sessionStorage.setItem("afterLoginRedirect",v);const e=await h(a,l);if(!e||!e.success)throw new Error((null==(t=null==e?void 0:e.error)?void 0:t.toString())||"Autentificare eșuată");n.debug("Autentificare reușită, redirecționare către:",v),j(v,{replace:!0})}catch(r){n.error("Eroare detaliată la autentificare:",r);let e="A apărut o eroare la autentificare. Vă rugăm să încercați din nou.";if("object"==typeof r&&null!==r){const a=r;"auth/wrong-password"===a.code?e="Parolă incorectă. Vă rugăm să încercați din nou.":"auth/user-not-found"===a.code?e="Nu există niciun cont asociat cu acest email.":"auth/invalid-email"===a.code?e="Adresa de email nu este validă.":"auth/too-many-requests"===a.code?e="Prea multe încercări eșuate. Vă rugăm să încercați mai târziu.":a.message&&(e=a.message)}f(e)}finally{m(!1)}else f("Te rugăm să completezi atât email-ul cât și parola.")},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"email",children:"Email"}),t.jsx("input",{type:"email",id:"email",value:a,onChange:e=>c(e.target.value),required:!0,className:"form-control"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"password",children:"Parolă"}),t.jsx("input",{type:"password",id:"password",value:l,onChange:e=>u(e.target.value),required:!0,className:"form-control"})]}),t.jsx("button",{type:"submit",className:"btn btn-primary btn-block",disabled:d,children:d?"Se autentifică...":"Autentificare"})]}),t.jsxs("div",{className:"login-alternatives",children:[t.jsxs("button",{onClick:async()=>{var e;try{m(!0),f(""),n.debug("Încercare de autentificare cu Google, redirectPath:",v),sessionStorage.setItem("afterLoginRedirect",v),sessionStorage.setItem("googleAuthOriginalPath",v);const a=await p(v);if(a&&!a.success)throw new Error((null==(e=a.error)?void 0:e.toString())||"Autentificare eșuată");n.debug("Google login initiated, will redirect after authentication")}catch(a){n.error("Eroare la autentificarea cu Google:",a),f("A apărut o eroare la autentificarea cu Google."),m(!1)}},className:"btn btn-outline-secondary btn-block",disabled:d,type:"button",children:[t.jsx("i",{className:"fab fa-google"})," Autentificare cu Google"]}),t.jsx("div",{className:"text-center mt-3",children:t.jsx(o,{to:"/forgot-password",children:"Am uitat parola"})}),t.jsxs("div",{className:"text-center mt-2",children:["Nu aveți cont? ",t.jsx(o,{to:"/register",children:"Înregistrare"})]})]})]})})};export{c as default};
