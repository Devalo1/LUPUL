import{a as e,j as t,d as s}from"./index-wFNFqtXh.js";import{u as i,b as r}from"./vendor-BbhD7xee.js";import{q as a,t as n}from"./firebase-Bc5mL6iy.js";import{n as l,o as c,p as o,q as d,r as m}from"./index-BlmLpygs.js";import{E as u}from"./ErrorMessage-BUKWsR5Z.js";const x=[{id:"default-1",title:"Bine ai venit în comunitatea noastră!",date:(new Date).toLocaleDateString("ro-RO"),author:"Echipa Lupul Corbul",preview:"Un mesaj special de bun venit pentru tine...",content:"Dragă prieten,\n\nTe întâmpinăm cu bucurie în comunitatea noastră! Suntem încântați că ai decis să ni te alături în această călătorie de dezvoltare personală și descoperire.\n\nÎn următoarele săptămâni, vei primi mai multe resurse și scrisori personalizate care te vor ghida în acest proces de transformare.\n\nCu apreciere,\nEchipa Lupul Corbul"}],h=()=>{var h,p,b,j;const{user:f,loading:g,isAuthenticated:v}=e(),N=i(),y=r.useRef(!1),[w,S]=r.useState(null),[D,z]=r.useState(x),[C,E]=r.useState(!0),[R,L]=r.useState(null),A=r.useRef(!1),O=(null==f?void 0:f.displayName)||"prieten";return r.useEffect((()=>{g||v||y.current||(y.current=!0,N("/login",{replace:!0}))}),[g,v,N]),r.useEffect((()=>{const e=async(t=0)=>{if(!A.current&&!g&&v){A.current=!0;try{if(E(!0),L(null),!s)throw new Error("Database connection error");z(x);try{const e=a(s,"articles"),t=await n(e);if(!t.empty){const e=[];if(t.docs.forEach((t=>{try{const s=t.data();e.push({id:t.id,title:s.title||"Titlu lipsă",date:s.date||(new Date).toLocaleDateString("ro-RO"),author:s.author||"Autor necunoscut",preview:s.preview||(s.content?s.content.substring(0,100)+"...":"Previzualizare indisponibilă"),content:s.content||"Conținut indisponibil"})}catch(s){}})),e.length>0){const t=e.map((e=>{let t=e.content;return t=t.replace('${user?.displayName || "prieten"}',O),{...e,content:t}}));return z(t),void L(null)}}}catch(i){t<1&&(A.current=!1,setTimeout((()=>e(t+1)),3e3))}}catch(r){L("Nu s-au putut încărca articolele. Vă rugăm încercați din nou mai târziu.")}finally{E(!1)}}};v&&f&&!g&&e()}),[f,g,v,O]),g?t.jsx("div",{className:"flex justify-center items-center min-h-screen",children:"Se încarcă autentificarea..."}):v?C&&0===D.length?t.jsx("div",{className:"flex justify-center items-center min-h-screen",children:"Se încarcă articolele..."}):t.jsx("div",{className:"min-h-screen bg-gray-100",children:t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8 border-l-4 border-yellow-500",children:[t.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["Bun venit, ",(null==f?void 0:f.displayName)||(null==f?void 0:f.email)||"Utilizator","!"]}),t.jsxs("p",{className:"text-gray-600",children:["Membru din ",f&&f.createdAt?new Date(f.createdAt).toLocaleDateString("ro-RO"):(new Date).toLocaleDateString("ro-RO")]})]}),R&&t.jsx(u,{message:R,onRetry:()=>{A.current=!1,window.location.reload()}}),t.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[t.jsx("h3",{className:"text-2xl font-semibold text-gray-800 mb-6 border-b pb-2",children:"Scrisori pentru sănătate și inspirație"}),0!==D.length||R?w?t.jsxs("div",{className:"letter-open",children:[t.jsxs("button",{className:"flex items-center text-blue-600 hover:text-blue-800 mb-4 transition duration-200",onClick:()=>S(null),children:[t.jsx(l,{className:"mr-2"})," Înapoi la toate scrisorile"]}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-8 my-4 shadow-inner max-w-3xl mx-auto",children:D.find((e=>e.id===w))&&t.jsxs(t.Fragment,{children:[t.jsx("h4",{className:"text-2xl font-bold text-gray-800 mb-2",children:null==(h=D.find((e=>e.id===w)))?void 0:h.title}),t.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-6 border-b border-yellow-200 pb-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(c,{className:"mr-1"}),null==(p=D.find((e=>e.id===w)))?void 0:p.date]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(o,{className:"mr-1"}),null==(b=D.find((e=>e.id===w)))?void 0:b.author]})]}),t.jsx("div",{className:"text-gray-700 leading-relaxed letter-content whitespace-pre-line",children:null==(j=D.find((e=>e.id===w)))?void 0:j.content})]})})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map((e=>t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition duration-200 overflow-hidden",children:t.jsxs("div",{className:"p-5 cursor-pointer",onClick:()=>S(e.id),children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsx("div",{className:"text-yellow-600",children:t.jsx(d,{size:24})}),t.jsx("div",{className:"text-xs text-gray-500",children:e.date})]}),t.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:e.title}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.preview}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-xs text-gray-500",children:["De la: ",e.author]}),t.jsxs("button",{className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium",onClick:t=>{t.stopPropagation(),S(e.id)},children:["Citește ",t.jsx(m,{className:"ml-1"})]})]})]})},e.id)))}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nu există scrisori disponibile momentan. Reveniți mai târziu."})]})]})}):t.jsx("div",{className:"flex justify-center items-center min-h-screen",children:"Se redirecționează către login..."})};export{h as default};
